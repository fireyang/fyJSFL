function main(dom){	//fl.trace(dom);	if(dom ==undefined){		var dom = fl.getDocumentDOM();	}	if(dom == undefined){		return;	}	var lib = dom.library;	//fl.trace("lib:"+lib);	var items = lib.items;	var list = ["movie clip","button"];	//unGroupAll(dom);	//return;	for(var i=0;i<items.length;i++){		var item = items[i];		//var linkClassName = item.linkageClassName;		//fl.trace(list.indexOf(item.itemType));		if(list.indexOf(item.itemType)!=-1){			//fl.trace("test");			changeFont(dom,lib,item);		}		//fl.trace(item.linkageClassName);	}	//fl.outputPanel.clear();}function changeFont(dom,lib,itemMc){	fl.trace("start=====:"+itemMc.name);	//lib.selectItem(itemMc.name);	lib.editItem([itemMc.name]);	var layerNum = dom.getTimeline().layerCount;	allLayers = dom.getTimeline().layers;	for(var i=0;i<layerNum;i++){		var curLayer = allLayers[i];		var frameNum = curLayer.frameCount;		//fl.trace(curLayer);		//fl.trace(i);		for(var j=0;j<frameNum;j++){			var curFrame = curLayer.frames[j];			//fl.trace(curFrame+"-"+j);			if(curFrame == undefined){				continue;			}			if(curFrame.startFrame == j){				//fl.trace("frame:"+i+","+j);				var allMcs = curFrame.elements;				for(var n=0;n<allMcs.length;n++){					var mc = allMcs[n];					///var obj = fl.findObjectInDocByName(mc.name,dom);					if(mc.elementType == "text" ){						//dom.setElementTextAttr('face', 'SimSun');						//fl.trace("b:"+mc.fontRenderingMode);						//changeFont(dom,lib,mc.libraryItem);						//fl.trace("c:"+mc.getTextString());						var fontStr = mc.getTextAttr("face");						//fl.trace(fontStr == "Microsoft YaHei");						if(fontStr == "Microsoft YaHei" || fontStr == undefined){							mc.setTextAttr("face","SimSun");						}						//fl.trace("c:"+);					}				}			}		}	}	//.frames[0].actionScript = 'stop();';}//main();function openFile(){	fl.outputPanel.clear();			//var filePath = fl.browseForFileURL("open","select file");			//return;		var folderPath = fl.browseForFolderURL("open","select file");		fl.trace(folderPath);		var fileList= FLfile.listFolder(folderPath,"files");		//fl.trace(fileList);		for each(var fName in fileList){			//fl.trace(fName);			//fl.trace(fName.lastIndexOf(".fla"));			if(fName.lastIndexOf(".fla")!=-1){				fl.trace(fName+"====");				fl.openDocument(folderPath+"/"+fName);				var dom = fl.getDocumentDOM();				main(dom);				//fl.closeDocument(dom,);				fl.saveDocument(dom);				fl.closeDocument(dom);				//fl.trace(dom);				//fl.closeDocument(dom);			}			//fl.trace(fName);		}		//fl.openDocument(filePath);		//dom = fl.getDocumentDOM();}fl.outputPanel.clear();//openFile();main();