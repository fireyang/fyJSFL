//fl.trace("test");//var code=FLfile.read("///Volumes/hd2/workspace/newGame/res/a.txt");//fl.trace("c:"+code);//fl.trace(fl.configURI);function start(window){	fl.outputPanel.clear();	var mainPath = fl.browseForFolderURL("选择目录");	if ((mainPath == null))	{		return;	}	var fileList = getTxtFiles(mainPath);	if (fileList.length > 0)	{		fl.createDocument();		var dom = fl.getDocumentDOM();		var lib = dom.library;		for each (var file in fileList)		{			var pathArr = file.split(".");			var fileName = pathArr[0];			var picFolder = mainPath + "/" + fileName + "all/";			var folderName = "pngs_" + fileName;			lib.newFolder(folderName);			fl.trace(picFolder);			//导入图片			ergodicFolder(picFolder,dom,folderName);			//读取帧信息			file = mainPath + "/" + file;			var posSet = FLfile.read(file);			var frameList = posSet.split(";");			//新建元件			lib.addNewItem('movie clip',fileName);			lib.editItem(fileName);			//添加到帧			var tline = dom.getTimeline();			for (var i = 0; i < frameList.length; i++)			{				var list = frameList[i].split(",");				var pngName = folderName + '-' + list[1];				var isSelect = lib.selectItem(((folderName + "/") + pngName));				var xpos = parseInt(list[2]);				var ypos = parseInt(list[3]);				lib.addItemToDocument({x:0,y:0});				dom.selectAll();				dom.setElementProperty("x",xpos);				dom.setElementProperty("y",ypos);				if ((i < frameList.length - 1))				{					tline.insertBlankKeyframe();				}			}		}		var mainArr = mainPath.split("/");		var mainName = mainArr.pop();		mainPath = mainArr.join("/");		fl.saveDocument(dom,mainPath + "/"+mainName+".fla");		alert("处理完毕！");		fl.outputPanel.clear();	}	else	{		//没有可以处理		alert("没有可以处理的资源！");	}}start(this);//获取文本文件;function getTxtFiles(path){	if (! FLfile.exists(path))	{		alert("文件不存在");		return;	}	var list = FLfile.listFolder(path);	var txtList = [];	//fl.trace("aa");	if (list.length > 0)	{		for each (var file in list)		{			if (file.indexOf(".txt") != -1)			{				txtList.push(file);			}		}		return txtList;	}	else	{		alert("文件夹空或不是文件夹");	}}//浏览器版本;function getFlashVersion(){	var flVersion = fl.version;	var flarr = flVersion.split(" ");	var platform = flarr[0];	var v = flarr[1].split(",");	var curVersion = v[0];	return curVersion;}//ergodicFolder(picDirt);//var code=FLfile.read(filePath);//fl.trace(code);//var dom =fl.getDocumentDOM();//dom.importFile();/** * 导入文件到库 * 并生成包含此文件的元件 * @document 文档引用 * @filePath 导入的文件路径 * @packageName 包名, 若无包名，则无需填写；如果有，则以"."结尾 */function importFile(document,filePath,packageName){	//fl.trace(("im:" + filePath));	document.importFile(filePath,true);}/** * 遍历文件夹 * @path 文件夹路径，以"/"或者"\\"结尾 * @packageName 包名，, 若无包名，则无需填写；如果有，则以"."结尾 */function ergodicFolder(path,dom,folder){	var lib = dom.library;	var files = FLfile.listFolder(path,"files");	if ((files != null))	{		for (var i = 0; i < files.length; i++)		{			var fileName = files[i];			if ((fileName == ".DS_Store"))			{				continue;			}			var file = path + fileName;			if (! dom.library.itemExists(fileName))			{				importFile(dom,file);				if (! lib.itemExists(fileName))				{					fileName = fileName.split(".")[0];				}				var isSelect = lib.selectItem(fileName);				if (isSelect)				{					var item = lib.getSelectedItems()[0];					//重名名					var lastNum = fileName.lastIndexOf(".png");					var fileIndex = "";					if ((lastNum != -1))					{						var fileIndex = fileName.substr(1,lastNum - 1);					}					else					{						fileIndex = fileName.substr(1);					}					item.name = folder + "-" + fileIndex;					//放到文件夹					lib.moveToFolder(folder,item.name);				}			}		}	}	/*	忽略文件夹	var folders = FLfile.listFolder(path,"directories");	if ((folders != null))	{	for (var i = 0; i < folders.length; i++)	{	ergodicFolder(((path + folders[i]) + "/"),dom,folder);	}	}*/}